# Bannerlord 1.3 API Changes Summary

Key API changes between Bannerlord 1.2 and 1.3 that affect modding.

---

## Breaking Changes

### Mission API

```csharp
// 1.2
public Mission(MissionInitializerRecord rec, ...)

// 1.3 - Parameters may have changed
// Verify current signature before use
```

### Campaign Events

Some campaign event delegates have changed signatures. Verify:
- `OnSessionLaunchedEvent`
- `OnNewGameCreatedEvent`
- `DailyTickEvent`
- `HourlyTickEvent`

### Party Management

```csharp
// Methods to verify:
MobileParty.CreateParty()
PartyBase.AddMember()
TroopRoster operations
```

### Settlement Access

```csharp
// Methods to verify:
Settlement.Town property access
Settlement.Village property access
Settlement component queries
```

---

## Renamed/Moved Types

| 1.2 Name | 1.3 Name | Notes |
|----------|----------|-------|
| TBD | TBD | Verify during migration |

---

## Removed Methods

| Type | Method | Replacement |
|------|--------|-------------|
| TBD | TBD | TBD |

---

## New Required Overrides

Some GameModel classes may require new method overrides:

```csharp
// Verify these models for required overrides:
- DefaultPartySpeedCalculatingModel
- DefaultSettlementFoodModel
- DefaultAgeDeath Model
```

---

## Harmony Compatibility

### Harmony Version
- 1.2: Harmony 2.2.x
- 1.3: Harmony 2.3.x (verify exact version)

### Patch Signature Changes

Some TaleWorlds methods may have changed signatures. Re-verify all patches:

```csharp
[HarmonyPatch(typeof(SomeClass), "SomeMethod")]
// Verify method still exists with same signature
```

---

## XML Schema Changes

### Module XML

```xml
<!-- 1.2 format -->
<Module>
  <Name value="ModName"/>
  <Version value="1.0.0"/>
  ...
</Module>

<!-- 1.3 format - verify required attributes -->
```

### Culture XML

```xml
<!-- Verify these elements/attributes -->
<Culture id="..." name="...">
  <default_face_key>...</default_face_key>
  <!-- New/changed elements -->
</Culture>
```

### Settlement XML

```xml
<!-- Verify component structure -->
<Settlement id="..." name="...">
  <Components>
    <!-- Structure may have changed -->
  </Components>
</Settlement>
```

---

## Recommended Approach

1. **Update Dependencies First**
   - Update NuGet package references
   - Update Harmony version
   - Verify build compiles

2. **Fix Compilation Errors**
   - Address renamed/removed types
   - Update method signatures
   - Fix new required overrides

3. **Re-verify Harmony Patches**
   - Check each patch target still exists
   - Verify method signatures match
   - Test patch application

4. **Update XML Files**
   - Follow xml-migration-strategy.md
   - Test each file individually
   - Verify in-game loading

5. **Full Testing**
   - New campaign test
   - Existing save compatibility (if supported)
   - All mod features

---

## Resources

- TaleWorlds official documentation
- BUTR community tools and analyzers
- Bannerlord modding Discord

---

## Notes

This document will be updated as specific API changes are discovered during migration. Document any changes you find here for future reference.
